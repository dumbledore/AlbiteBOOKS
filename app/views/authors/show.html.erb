<% title @author.name %>

<% content_for(:head) do %>
  <% @freebase_item = @author %>
  <%= render :partial => 'misc/freebase_ajax' %>
<% end %>

<h1>
  <%=h @author.name %>
  <% if user_admin %>
    <%= link_to image_tag("misc/edit.png"), edit_author_path(@author), :class => 'small' %>
    <%= link_to image_tag("misc/delete.png"), @author, :confirm => 'Are you sure you want to delete this author and their books and translations?', :method => :delete, :class => 'small' %>
  <% end %>
</h1>
<p>
  <%= image_tag(@author.thumbnail_url, :class =>  'thumbnail') unless @author.thumbnail_url.blank? %>
  <span id="freebase_description"><span class="loading">Loading... <%= image_tag '_/loading.gif' %></span></span>
</p>

<div id="freebase_bio"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>

<% if @author.author_aliases.size > 1 %>
  <p>
  <strong>Also known as: </strong>
  <% aliases = [] %>
  <% for aliaz in @author.author_aliases %>
    <% aliases << aliaz.name unless @author.alias_name == aliaz %>
  <% end %>
  <%= aliases.join(", ") %>
  </p>
<% end %>
<div></div>

<h1>Books</h1>
<% @books = @author.books %>
<% @book_thumbnails = true %>
<% @no_books_message = 'No books have been added, so far.' %>
<%= render :partial => 'books/index' %>

<div id="freebase_quotes"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>
<%= render :partial => 'misc/qr_code' %>
<div id="freebase_links"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>
<h1>Comments</h1>
<% @disqus = 'author_' + @author.id.to_s %>
<%= render :partial => 'misc/disqus_thread' %>
<% content_for(:tail) do %>
  <%= render :partial => 'misc/disqus_tail' %>
<% end %>

<%= "<p><b>#{h(link_to("New author", :controller => 'authors', :action => 'new'))}</b></p>".html_safe if user_admin %>
<%= "<p><b>#{h(link_to("New book", :controller => 'books', :action => 'new', :author => @author))}</b></p>".html_safe if user_admin %>

<p>
  <%= link_to "Back to Authors", authors_url %>
</p>
