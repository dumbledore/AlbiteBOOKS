<% title @author.name %>

<% content_for(:head) do %>
  <% @freebase_item = @author %>
  <%= render :partial => 'misc/freebase_ajax' unless @mobile %>
<% end %>

<h1>
  <%=h @author.name %>
  <% if user_admin %>
    <%= link_to image_tag("misc/edit.png"), edit_author_path(@author), :class => 'small' %>
    <%= link_to image_tag("misc/delete.png"), @author, :confirm => 'Are you sure you want to delete this author and their books and translations?', :method => :delete, :class => 'small' %>
  <% end %>
</h1>
<p>
  <%= image_tag(@author.thumbnail_url, :class =>  'thumbnail') unless @author.thumbnail_url.blank? %>
  <% if @mobile %>
    <%= @author.description %>  
  <% else %>
    <span id="freebase_description"><span class="loading">Loading... <%= image_tag '_/loading.gif' %></span></span>
  <% end %>
</p>
<% if @mobile %>
  <p><strong>Born: </strong><%= @author.date_and_place_of_birth %></p>
  <p><strong>Died: </strong><%= @author.date_and_place_of_death %></p>
  <p><strong>Country of nationality: </strong><%= @author.country_of_nationality %></p>
<% else %>
  <div id="freebase_bio"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>
<% end %>
<% if @author.aliases.size > 1 %>
  <p>
  <strong>Also known as: </strong>
  <% aliases = [] %>
  <% for aliaz in @author.aliases %>
    <% aliases << aliaz.name unless @author.alias_name == aliaz %>
  <% end %>
  <%= aliases.join(", ") %>
  </p>
<% end %>
<div></div>

<h1>Books</h1>
<% @books = @author.books %>
<% @book_thumbnails = true %>
<% @no_books_message = 'No books have been added, so far.' %>
<%= render :partial => 'books/index' %>

<% unless @mobile %>
  <div id="freebase_quotes"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>
  <%= render :partial => 'misc/qr_code' %>
  <div id="freebase_links"><div class="loading">Loading... <%= image_tag '_/loading.gif' %></div></div>
  <h1>Comments</h1>
  <% @disqus = 'author_' + @author.id.to_s %>
  <%= render :partial => 'misc/disqus_thread' %>
  <% content_for(:tail) do %>
    <%= render :partial => 'misc/disqus_tail' %>
  <% end %>
<% end %>

<%= "<p><b>#{h(link_to("New author", :controller => 'authors', :action => 'new'))}</b></p>".html_safe if user_admin %>
<%= "<p><b>#{h(link_to("New book", :controller => 'books', :action => 'new', :author => @author))}</b></p>".html_safe if user_admin %>

<p>
  <br>
  <%= link_to "Back to Authors", authors_url %>
</p>